"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7719],{76:(Z,A,s)=>{s.d(A,{GW:()=>u,dk:()=>t,oK:()=>d});var d=(()=>{return(e=d||(d={})).Prompt="PROMPT",e.Camera="CAMERA",e.Photos="PHOTOS",d;var e})(),u=(()=>{return(e=u||(u={})).Rear="REAR",e.Front="FRONT",u;var e})(),t=(()=>{return(e=t||(t={})).Uri="uri",e.Base64="base64",e.DataUrl="dataUrl",t;var e})()},5045:(Z,A,s)=>{s.d(A,{n:()=>d});class d{isErrorState(t,e){return!(!t?.invalid||!t?.parent?.dirty)||!(!t?.parent?.invalid||!t?.parent?.dirty)}}},3013:(Z,A,s)=>{s.d(A,{l:()=>a});var d=s(1086),u=s(2868),t=s(7221),e=s(2340),_=s(4650),b=s(529),y=s(9709);class a{http;appconfig;constructor(p,P){this.http=p,this.appconfig=P}getByAdvanceSearch(p){return this.http.post(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByAdvanceSearch,p).pipe((0,u.b)(P=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}getByCode(p){return this.http.get(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByCode+p).pipe((0,u.b)(P=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}create(p){return this.http.post(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.create,p).pipe((0,u.b)(P=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}updateProfile(p,P){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfile+p,P).pipe((0,u.b)(C=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}resetPassword(p,P){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.resetPassword+p,P).pipe((0,u.b)(C=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}updateProfilePicture(p,P){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfilePicture+p,P).pipe((0,u.b)(C=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}delete(p){return this.http.delete(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.delete+p).pipe((0,u.b)(P=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}handleError(p="operation",P){return C=>(this.log(`${p} failed: ${Array.isArray(C.error.message)?C.error.message[0]:C.error.message}`),(0,d.of)(C.error))}log(p){console.log(p)}static \u0275fac=function(P){return new(P||a)(_.LFG(b.eN),_.LFG(y._))};static \u0275prov=_.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}},7826:(Z,A,s)=>{s.d(A,{f:()=>i});var d=s(5861),u=s(4006),t=s(5045),e=s(4650),_=s(263),b=s(3013),y=s(603),a=s(7956),h=s(3746),p=s(6895),P=s(7392),C=s(9549),E=s(4144);function O(g,m){1&g&&(e.TgZ(0,"span",23),e._uU(1," Please enter your password "),e.qZA())}function f(g,m){1&g&&(e.TgZ(0,"span",23),e._uU(1," Password is incorrect "),e.qZA())}function n(g,m){1&g&&(e.TgZ(0,"span",23),e._uU(1," Please enter new password "),e.qZA())}function r(g,m){1&g&&(e.TgZ(0,"span",23),e._uU(1," Confirm Password is required "),e.qZA())}function o(g,m){1&g&&(e.TgZ(0,"span",23),e._uU(1," Password not match "),e.qZA())}class i{authService;parentsService;formBuilder;actionSheetController;alertController;pageLoaderService;storageService;modal;currentUser;changePasswordForm;activeAditionalBackdrop=!1;isSubmitting=!1;matcher=new t.n;error;constructor(m,c,l,v,M,S,U){this.authService=m,this.parentsService=c,this.formBuilder=l,this.actionSheetController=v,this.alertController=M,this.pageLoaderService=S,this.storageService=U,this.currentUser=this.storageService.getLoginUser()}get formData(){return this.changePasswordForm.value}get errorControls(){return this.changePasswordForm.controls}get notSameValueErrorHandler(){return this.changePasswordForm.errors}ngOnInit(){this.changePasswordForm=this.formBuilder.group({currentPassword:[null,u.kI.required],password:[null,u.kI.required],confirmPassword:""},{validators:this.checkPasswords})}checkPasswords=m=>m.get("password").value===m.get("confirmPassword").value?null:{notSame:!0};onSubmit(){var m=this;return(0,d.Z)(function*(){const c=m.formData;if(m.changePasswordForm.valid)try{const l=yield m.actionSheetController.create({cssClass:"app-action-sheet",header:"Are you sure you want to change your password?",buttons:[{text:"Yes?",handler:(v=(0,d.Z)(function*(){l.dismiss(),m.save(c)}),function(){return v.apply(this,arguments)})},{text:"No",handler:function(){var v=(0,d.Z)(function*(){l.dismiss()});return function(){return v.apply(this,arguments)}}()}]});yield l.present()}catch(l){m.isSubmitting=!1,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Try again!",message:Array.isArray(l.message)?l.message[0]:l.message,buttons:["OK"]})}var v})()}save(m){var c=this;return(0,d.Z)(function*(){try{yield c.pageLoaderService.open("Saving..."),c.isSubmitting=!0;const l=yield c.authService.login({userName:c.currentUser.user.userName,password:m.currentPassword}).toPromise();if(l.success){const v=yield c.parentsService.resetPassword(c.currentUser.parentCode,m).toPromise();v.success?(yield c.pageLoaderService.close(),yield c.presentAlert({header:"Password changed!",buttons:["OK"]}),c.isSubmitting=!1,c.modal.dismiss(v.data,"confirm")):(c.isSubmitting=!1,yield c.pageLoaderService.close(),c.error=Array.isArray(v.message)?v.message[0]:v.message,yield c.presentAlert({header:"Try again!",message:c.error,buttons:["OK"]}))}else c.isSubmitting=!1,c.error=Array.isArray(l.message)?l.message[0]:l.message,console.log(l.message),c.changePasswordForm.controls.currentPassword.setErrors({incorrectPassword:!0}),c.changePasswordForm.controls.currentPassword.markAllAsTouched()}catch(l){c.isSubmitting=!1,yield c.pageLoaderService.close(),c.error=Array.isArray(l.message)?l.message[0]:l.message,yield c.presentAlert({header:"Try again!",message:c.error,buttons:["OK"]})}})()}close(){this.modal.dismiss(null,"cancel")}presentAlert(m){var c=this;return(0,d.Z)(function*(){return yield(yield c.alertController.create(m)).present()})()}static \u0275fac=function(c){return new(c||i)(e.Y36(_.e),e.Y36(b.l),e.Y36(u.qu),e.Y36(y.BX),e.Y36(y.Br),e.Y36(a.p),e.Y36(h.V))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-password-and-security"]],decls:44,vars:12,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","chevron-back","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],[1,"ion-padding"],["id","petForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","password","placeholder","Current Password","formControlName","currentPassword","autocomplete","new-currentPassword"],["currentPassword",""],["matSuffix","",1,"icon-right",2,"cursor","pointer",3,"click"],["class","error",4,"ngIf"],["matInput","","type","password","placeholder","Password","formControlName","password","autocomplete","new-password"],["password",""],["matInput","","type","password","placeholder","Confirm password","formControlName","confirmPassword","autocomplete","new-confirmPassword",3,"errorStateMatcher"],["confirmPassword",""],[1,"controls-bottom"],["mode","md","type","submit","mat-flat-button","","color","primary","form","petForm",3,"disabled"],[1,"error"]],template:function(c,l){if(1&c){const v=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e.NdJ("click",function(){return l.close()}),e._UZ(4,"ion-icon",4),e.qZA()(),e.TgZ(5,"ion-title",5)(6,"h1",6),e._uU(7,"Password and security"),e.qZA()(),e._UZ(8,"div",7),e.qZA()(),e.TgZ(9,"ion-content",8)(10,"form",9),e.NdJ("ngSubmit",function(){return!!l.changePasswordForm.valid&&l.onSubmit()}),e.TgZ(11,"fieldset",10)(12,"div",11)(13,"mat-label"),e._uU(14,"Current Password"),e.qZA(),e.TgZ(15,"mat-form-field",12),e._UZ(16,"input",13,14),e.TgZ(18,"mat-icon",15),e.NdJ("click",function(){e.CHM(v);const S=e.MAs(17);return e.KtG(S.type="password"===S.type?"text":"password")}),e._uU(19),e.qZA()(),e.YNc(20,O,2,0,"span",16),e.YNc(21,f,2,0,"span",16),e.qZA(),e.TgZ(22,"div",11)(23,"mat-label"),e._uU(24,"New Password"),e.qZA(),e.TgZ(25,"mat-form-field",12),e._UZ(26,"input",17,18),e.TgZ(28,"mat-icon",15),e.NdJ("click",function(){e.CHM(v);const S=e.MAs(27);return e.KtG(S.type="password"===S.type?"text":"password")}),e._uU(29),e.qZA()(),e.YNc(30,n,2,0,"span",16),e.qZA(),e.TgZ(31,"div",11)(32,"mat-label"),e._uU(33,"Confirm Password"),e.qZA(),e.TgZ(34,"mat-form-field",12),e._UZ(35,"input",19,20),e.TgZ(37,"mat-icon",15),e.NdJ("click",function(){e.CHM(v);const S=e.MAs(36);return e.KtG(S.type="password"===S.type?"text":"password")}),e._uU(38),e.qZA()(),e.YNc(39,r,2,0,"span",16),e.YNc(40,o,2,0,"span",16),e.qZA()()()(),e.TgZ(41,"div",21)(42,"ion-button",22),e._uU(43,"Update password"),e.qZA()()}if(2&c){const v=e.MAs(17),M=e.MAs(27),S=e.MAs(36);e.xp6(10),e.Q6J("formGroup",l.changePasswordForm),e.xp6(1),e.Q6J("disabled",l.isSubmitting),e.xp6(8),e.Oqu("password"===v.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",l.errorControls.currentPassword.touched&&l.errorControls.currentPassword.errors&&l.errorControls.currentPassword.errors.required),e.xp6(1),e.Q6J("ngIf",l.errorControls.currentPassword.touched&&l.errorControls.currentPassword.errors&&l.errorControls.currentPassword.errors.incorrectPassword),e.xp6(8),e.Oqu("password"===M.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",l.errorControls.password.touched&&l.errorControls.password.errors&&l.errorControls.password.errors.required),e.xp6(5),e.Q6J("errorStateMatcher",l.matcher),e.xp6(3),e.Oqu("password"===S.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",l.errorControls.confirmPassword.touched&&l.errorControls.confirmPassword.errors&&l.errorControls.confirmPassword.errors.required),e.xp6(1),e.Q6J("ngIf",l.errorControls.confirmPassword.touched&&l.notSameValueErrorHandler&&l.notSameValueErrorHandler.notSame),e.xp6(2),e.Q6J("disabled",!l.changePasswordForm.valid||l.isSubmitting)}},dependencies:[p.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,y.YG,y.Sm,y.W2,y.Gu,y.gu,y.wd,y.sr,P.Hw,C.KE,C.hX,C.R9,E.Nt],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.controls-bottom[_ngcontent-%COMP%]{position:relative;display:block;width:100%;background:#ffffff;padding:5px 10px;box-shadow:0 3px 10px #0003}.controls-bottom[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;font-size:15px;width:100%}"]})}},4787:(Z,A,s)=>{s.d(A,{B:()=>E});var d=s(5861),u=s(4006),t=s(4650),e=s(3013),_=s(603),b=s(7956),y=s(3746),a=s(6895),h=s(9549),p=s(4144);function P(O,f){1&O&&(t.TgZ(0,"span",17),t._uU(1," Full Name is required "),t.qZA())}function C(O,f){1&O&&(t.TgZ(0,"span",17),t._uU(1," Mobile number is required "),t.qZA())}class E{parentsService;formBuilder;alertController;pageLoaderService;storageService;actionSheetController;modal;currentUser;editProfileForm;activeAditionalBackdrop=!1;isSubmitting=!1;constructor(f,n,r,o,i,g){this.parentsService=f,this.formBuilder=n,this.alertController=r,this.pageLoaderService=o,this.storageService=i,this.actionSheetController=g,this.currentUser=this.storageService.getLoginUser()}get formData(){return{...this.editProfileForm.value,parentId:this.currentUser.parentId}}get isFormDirty(){return this.currentUser.fullName!==this.formData.fullName||this.currentUser.mobileNumber!==this.formData.mobileNumber}get errorControls(){return this.editProfileForm.controls}ngOnInit(){this.editProfileForm=this.formBuilder.group({fullName:new u.NI(this.currentUser.fullName,u.kI.required),mobileNumber:new u.NI(this.currentUser.mobileNumber,u.kI.required)})}onSubmit(){var f=this;return(0,d.Z)(function*(){const n=f.formData;if(f.editProfileForm.valid)try{const r=yield f.actionSheetController.create({cssClass:"app-action-sheet",header:"Do you want to update profile settings?",buttons:[{text:"Yes?",handler:(o=(0,d.Z)(function*(){r.dismiss(),f.save(n)}),function(){return o.apply(this,arguments)})},{text:"No",handler:function(){var o=(0,d.Z)(function*(){r.dismiss()});return function(){return o.apply(this,arguments)}}()}]});yield r.present()}catch(r){f.isSubmitting=!1,yield f.pageLoaderService.close(),yield f.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}var o})()}save(f){var n=this;return(0,d.Z)(function*(){try{yield n.pageLoaderService.open("Saving..."),n.isSubmitting=!0,n.parentsService.updateProfile(n.currentUser.parentCode,f).subscribe(function(){var r=(0,d.Z)(function*(o){o.success?(yield n.pageLoaderService.close(),yield n.presentAlert({header:"Saved!",buttons:["OK"]}),n.isSubmitting=!1,n.currentUser.fullName=o.data.fullName,n.currentUser.mobileNumber=o.data.mobileNumber,n.storageService.saveLoginUser(n.currentUser),n.modal.dismiss(o.data,"confirm")):(n.isSubmitting=!1,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]}))});return function(o){return r.apply(this,arguments)}}(),function(){var r=(0,d.Z)(function*(o){n.isSubmitting=!1,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})});return function(o){return r.apply(this,arguments)}}())}catch(r){n.isSubmitting=!1,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})()}close(){this.modal.dismiss(null,"cancel")}presentAlert(f){var n=this;return(0,d.Z)(function*(){return yield(yield n.alertController.create(f)).present()})()}static \u0275fac=function(n){return new(n||E)(t.Y36(e.l),t.Y36(u.qu),t.Y36(_.Br),t.Y36(b.p),t.Y36(y.V),t.Y36(_.BX))};static \u0275cmp=t.Xpm({type:E,selectors:[["app-profile-settings"]],decls:28,vars:5,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","chevron-back","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],["mode","md",1,"ion-padding"],["id","editProfileForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","text","placeholder","Name","formControlName","fullName","autocomplete","new-fullName"],["class","error",4,"ngIf"],["matInput","","type","text","placeholder","Mobile number","formControlName","mobileNumber","autocomplete","new-mobileNumber"],["mode","md","type","submit","expand","full","shape","round","size","large","color","primary","form","editProfileForm",3,"disabled"],[1,"error"]],template:function(n,r){1&n&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.NdJ("click",function(){return r.close()}),t._UZ(4,"ion-icon",4),t.qZA()(),t.TgZ(5,"ion-title",5)(6,"h1",6),t._uU(7,"Profile settings"),t.qZA()(),t._UZ(8,"div",7),t.qZA()(),t.TgZ(9,"ion-content",8)(10,"form",9),t.NdJ("ngSubmit",function(){return!!r.editProfileForm.valid&&r.onSubmit()}),t.TgZ(11,"fieldset",10)(12,"div",11)(13,"mat-label"),t._uU(14,"Name"),t.qZA(),t.TgZ(15,"mat-form-field",12),t._UZ(16,"input",13),t.qZA(),t.YNc(17,P,2,0,"span",14),t.qZA(),t.TgZ(18,"div",11)(19,"mat-label"),t._uU(20,"Mobile number"),t.qZA(),t.TgZ(21,"mat-form-field",12),t._UZ(22,"input",15),t.qZA(),t.YNc(23,C,2,0,"span",14),t.qZA()()()(),t.TgZ(24,"ion-footer")(25,"ion-toolbar",1)(26,"ion-button",16),t._uU(27," Update "),t.qZA()()()),2&n&&(t.xp6(10),t.Q6J("formGroup",r.editProfileForm),t.xp6(1),t.Q6J("disabled",r.isSubmitting),t.xp6(6),t.Q6J("ngIf",r.errorControls.fullName.touched&&r.errorControls.fullName.errors&&r.errorControls.fullName.errors.required),t.xp6(6),t.Q6J("ngIf",r.errorControls.mobileNumber.touched&&r.errorControls.mobileNumber.errors&&r.errorControls.mobileNumber.errors.required),t.xp6(3),t.Q6J("disabled",!r.isFormDirty||r.isSubmitting))},dependencies:[a.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,_.YG,_.Sm,_.W2,_.fr,_.Gu,_.gu,_.wd,_.sr,h.KE,h.hX,p.Nt],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}ion-footer[_ngcontent-%COMP%]{display:flex}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;padding:5px 10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;flex-grow:1;font-size:18px;width:100%;margin:0!important}"]})}},7719:(Z,A,s)=>{s.d(A,{N:()=>O});var d=s(5861),u=s(7826),t=s(4787),e=s(7423);const _=(0,e.fo)("Filesystem",{web:()=>s.e(6364).then(s.bind(s,6364)).then(f=>new f.FilesystemWeb)});var b=s(76);const y=(0,e.fo)("Camera",{web:()=>s.e(3954).then(s.bind(s,3954)).then(f=>new f.CameraWeb)});var a=s(4650),h=s(603),p=s(3013),P=s(9773),C=s(263),E=s(3746);class O{actionSheetController;platform;parentsService;router;authService;modalCtrl;storageService;alertController;currentUser;profilePicSource;modal;routerOutlet;isSubmitting=!1;constructor(n,r,o,i,g,m,c,l){this.actionSheetController=n,this.platform=r,this.parentsService=o,this.router=i,this.authService=g,this.modalCtrl=m,this.storageService=c,this.alertController=l,this.currentUser=this.storageService.getLoginUser()}ngOnInit(){}onSettingsMenuClick(n){var r=this;return(0,d.Z)(function*(){let o=null;switch(n){case"profile-settings":o=yield r.modalCtrl.create({component:t.B,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,mode:"ios",componentProps:{modal:o}}),o.onWillDismiss().then(i=>{i.data&&"confirm"===i.role&&(r.currentUser=r.storageService.getLoginUser())}),o.present();break;case"password-and-security":o=yield r.modalCtrl.create({component:u.f,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,mode:"ios",componentProps:{modal:o}}),o.present()}})()}signout(){var n=this;return(0,d.Z)(function*(){const r=yield n.actionSheetController.create({cssClass:"app-action-sheet",buttons:[{text:"Logout?",handler:(o=(0,d.Z)(function*(){const i=yield n.actionSheetController.create({cssClass:"app-action-sheet",header:"Do you want to logout?",buttons:[{text:"Yes?",handler:(g=(0,d.Z)(function*(){n.authService.logout(),i.dismiss(),r.dismiss()}),function(){return g.apply(this,arguments)})},{text:"No",handler:function(){var g=(0,d.Z)(function*(){i.dismiss(),r.dismiss()});return function(){return g.apply(this,arguments)}}()}]});var g;yield i.present()}),function(){return o.apply(this,arguments)})},{text:"Cancel",handler:function(){var o=(0,d.Z)(function*(){r.dismiss()});return function(){return o.apply(this,arguments)}}()}]});var o;yield r.present()})()}ionViewWillEnter(){}close(){this.modal.dismiss(null,"cancel")}toggleDarkMode(){const n=window.matchMedia("(prefers-color-scheme: dark)");this.toggleDarkTheme(n.matches),n.addListener(r=>this.toggleDarkTheme(r.matches))}toggleDarkTheme(n){document.body.classList.toggle("dark",n)}onChangeProfilePic(){var n=this;return(0,d.Z)(function*(){const r=yield n.actionSheetController.create({cssClass:"sched-card-action-sheet",buttons:[{text:"Camera",handler:(o=(0,d.Z)(function*(){const i=yield y.getPhoto({quality:90,allowEditing:!1,resultType:b.dk.Uri,source:b.oK.Camera});if(i){const g=yield n.readAsBase64(i);n.profilePicSource=g,yield n.saveProfilePicture({userId:n.currentUser.user.userId,userProfilePic:{fileName:`profile-sample-name.${i.format}`,data:g}})}r.dismiss()}),function(){return o.apply(this,arguments)})},{text:"Gallery",handler:function(){var o=(0,d.Z)(function*(){const i=yield y.getPhoto({quality:90,allowEditing:!1,resultType:b.dk.Uri,source:b.oK.Photos});if(i){const g=yield n.readAsBase64(i);n.profilePicSource=g,yield n.saveProfilePicture({userId:n.currentUser.user.userId,userProfilePic:{fileName:`profile-sample-name.${i.format}`,data:g}})}r.dismiss()});return function(){return o.apply(this,arguments)}}()},{text:"Cancel",handler:function(){var o=(0,d.Z)(function*(){r.dismiss()});return function(){return o.apply(this,arguments)}}()}]});var o;yield r.present()})()}readAsBase64(n){var r=this;return(0,d.Z)(function*(){if(r.platform.is("hybrid"))return(yield _.readFile({path:n.path})).data;{const i=yield(yield fetch(n.webPath)).blob();return(yield r.convertBlobToBase64(i)).split(",")[1]}})()}convertBlobToBase64=n=>new Promise((r,o)=>{const i=new FileReader;i.onerror=o,i.onload=()=>{r(i.result)},i.readAsDataURL(n)});profilePicErrorHandler(n){n.target.src="../../../assets/img/profile-not-found.svg"}saveProfilePicture(n){var r=this;return(0,d.Z)(function*(){try{r.isSubmitting=!0,r.parentsService.updateProfilePicture(r.currentUser.parentCode,n).subscribe(function(){var o=(0,d.Z)(function*(i){console.log(i),i.success?(console.log(i),r.isSubmitting=!1,r.currentUser.userProfilePic=i.data.user.userProfilePic.file.url,r.storageService.saveLoginUser(r.currentUser)):(r.isSubmitting=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]}))});return function(i){return o.apply(this,arguments)}}(),function(){var o=(0,d.Z)(function*(i){r.isSubmitting=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})});return function(i){return o.apply(this,arguments)}}())}catch(o){r.isSubmitting=!1,yield r.presentAlert({header:"Try again!",message:Array.isArray(o.message)?o.message[0]:o.message,buttons:["OK"]})}})()}presentAlert(n){var r=this;return(0,d.Z)(function*(){return yield(yield r.alertController.create(n)).present()})()}static \u0275fac=function(r){return new(r||O)(a.Y36(h.BX),a.Y36(h.t4),a.Y36(p.l),a.Y36(P.F0),a.Y36(C.e),a.Y36(h.IN),a.Y36(E.V),a.Y36(h.Br))};static \u0275cmp=a.Xpm({type:O,selectors:[["app-settings"]],decls:36,vars:4,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","chevron-back","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],[1,"content"],[1,"row","profile"],[1,"col","avatar"],["id","profilePicture",3,"src","click","error"],[1,"col"],[1,"row","name"],[1,"row",2,"display","flex"],["lines","none",1,"nav-list"],["slot","start","name","person"],["slot","start","name","shield-checkmark"],["slot","start","name","exit"]],template:function(r,o){1&r&&(a.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),a.NdJ("click",function(){return o.close()}),a._UZ(4,"ion-icon",4),a.qZA()(),a.TgZ(5,"ion-title",5)(6,"h1",6),a._uU(7,"Settings"),a.qZA()(),a._UZ(8,"div",7),a.qZA()(),a.TgZ(9,"ion-content",1)(10,"div",8)(11,"div",9)(12,"div",10)(13,"ion-avatar")(14,"img",11),a.NdJ("click",function(){return o.onChangeProfilePic()})("error",function(g){return o.profilePicErrorHandler(g)}),a.qZA()()(),a.TgZ(15,"div",12)(16,"div",13)(17,"h1"),a._uU(18),a.qZA()()()(),a.TgZ(19,"div",14)(20,"ion-list",15)(21,"ion-item",3),a.NdJ("click",function(){return o.onSettingsMenuClick("profile-settings")}),a._UZ(22,"ion-icon",16),a.TgZ(23,"ion-label")(24,"h1"),a._uU(25,"Profile Settings"),a.qZA()()(),a.TgZ(26,"ion-item",3),a.NdJ("click",function(){return o.onSettingsMenuClick("password-and-security")}),a._UZ(27,"ion-icon",17),a.TgZ(28,"ion-label")(29,"h1"),a._uU(30,"Password and security"),a.qZA()()(),a.TgZ(31,"ion-item",3),a.NdJ("click",function(){return o.signout()}),a._UZ(32,"ion-icon",18),a.TgZ(33,"ion-label")(34,"h1"),a._uU(35,"Sign Out"),a.qZA()()()()()()()),2&r&&(a.xp6(14),a.Akn(o.isSubmitting?"opacity: 0.2":"opacity: 1"),a.Q6J("src",null==o.currentUser?null:o.currentUser.userProfilePic,a.LSH),a.xp6(4),a.Oqu(null==o.currentUser?null:o.currentUser.fullName))},dependencies:[h.BJ,h.YG,h.Sm,h.W2,h.Gu,h.gu,h.Ie,h.Q$,h.q_,h.wd,h.sr],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.content[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{display:flex}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{margin-top:10px;flex-direction:column;align-items:center}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{display:flex;padding:5px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{min-width:103px;min-height:103px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:600!important}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]{margin-top:20px;flex-direction:column;display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{white-space:break-spaces!important;line-height:1;height:-webkit-fill-available}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0!important}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item.active-menu[_ngcontent-%COMP%]::part(native){background-color:#f5f5f5}"]})}}}]);