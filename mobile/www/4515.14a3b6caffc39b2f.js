"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4515],{4515:(D,p,c)=>{c.d(p,{Q:()=>g});var l=c(5861),a=c(603),e=c(4650),m=c(5295),f=c(263),h=c(7956),M=c(7559),x=c(3746),d=c(6895);const P=["requestInfoModal"];function O(i,o){1&i&&e._UZ(0,"ion-icon",27)}function C(i,o){1&i&&e._UZ(0,"ion-icon",29)}function y(i,o){if(1&i&&e.YNc(0,C,1,0,"ion-icon",28),2&i){const t=e.oxw().$implicit,n=e.MAs(10);e.Q6J("ngIf","PENDING"===t.status)("ngIfElse",n)}}function q(i,o){if(1&i&&e._UZ(0,"ion-icon",30),2&i){const t=e.oxw().$implicit;e.s9C("name","REJECTED"===(null==t?null:t.status)?"close-circle":"remove-circle")}}function Z(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"ion-card",19)(2,"ion-card-content")(3,"ion-item",20),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(3),_=e.MAs(17);return u.current=s,e.KtG(_.present())}),e.TgZ(4,"ion-label")(5,"div",21),e.YNc(6,O,1,0,"ion-icon",22),e.YNc(7,y,1,2,"ng-template",null,23,e.W1O),e.YNc(9,q,1,1,"ng-template",null,24,e.W1O),e.TgZ(11,"div",25)(12,"h2",26),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"h1")(16,"strong"),e._uU(17),e.qZA()()()(),e.TgZ(18,"h2")(19,"strong"),e._uU(20),e.qZA()()()()()()()}if(2&i){const t=o.$implicit,n=e.MAs(8);e.xp6(6),e.Q6J("ngIf","APPROVED"===t.status)("ngIfElse",n),e.xp6(7),e.Oqu(e.xi3(14,5,t.dateRequested,"MMM dd, yyyy")),e.xp6(4),e.Oqu(t.student.fullName),e.xp6(3),e.Oqu(t.school.schoolName)}}function b(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"ion-button",31),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.loadMore())}),e.TgZ(1,"h2"),e._uU(2,"Load more..."),e.qZA()()}}function v(i,o){if(1&i&&(e.ynx(0),e.YNc(1,Z,21,8,"div",16),e.YNc(2,b,3,0,"ion-button",17),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.myRequests),e.xp6(1),e.Q6J("ngIf",t.myRequests&&t.myRequests.length>=t.limit&&t.myRequests.length<t.total)}}function R(i,o){if(1&i&&(e.ynx(0),e.YNc(1,v,3,2,"ng-container",11),e.BQk()),2&i){const t=e.oxw(),n=e.MAs(20);e.xp6(1),e.Q6J("ngIf",t.myRequests.length>0)("ngIfElse",n)}}function T(i,o){1&i&&e._UZ(0,"ion-icon",27)}function S(i,o){1&i&&e._UZ(0,"ion-icon",29)}function k(i,o){if(1&i&&e.YNc(0,S,1,0,"ion-icon",28),2&i){e.oxw();const t=e.MAs(17),n=e.oxw();e.Q6J("ngIf","PENDING"===(null==n.current?null:n.current.status))("ngIfElse",t)}}function A(i,o){if(1&i&&e._UZ(0,"ion-icon",30),2&i){const t=e.oxw(2);e.s9C("name","REJECTED"===(null==t.current?null:t.current.status)?"close-circle":"remove-circle")}}function E(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"ion-footer")(1,"ion-toolbar",1)(2,"ion-button",41),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onCancel())}),e._uU(3," Cancel "),e.qZA()()()}}function I(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1),e._UZ(2,"div",2)(3,"ion-title",3),e.TgZ(4,"ion-buttons",4)(5,"ion-button",5),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(17);return e.KtG(r.dismiss())}),e._UZ(6,"ion-icon",6),e.qZA()()()(),e.TgZ(7,"ion-content",1)(8,"div",32)(9,"h2"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"ion-item",33),e.YNc(13,T,1,0,"ion-icon",22),e.YNc(14,k,1,2,"ng-template",null,34,e.W1O),e.YNc(16,A,1,1,"ng-template",null,35,e.W1O),e.TgZ(18,"ion-label")(19,"h2",36)(20,"strong"),e._uU(21,"Status"),e.qZA()(),e.TgZ(22,"h1"),e._uU(23),e.qZA()()(),e.TgZ(24,"ion-item",37),e._UZ(25,"ion-icon",38),e.TgZ(26,"ion-label")(27,"h2",36)(28,"strong"),e._uU(29,"Student"),e.qZA()(),e.TgZ(30,"h2")(31,"strong"),e._uU(32),e.qZA()(),e.TgZ(33,"h1"),e._uU(34),e.qZA()()(),e.TgZ(35,"ion-item",37),e._UZ(36,"ion-icon",39),e.TgZ(37,"ion-label")(38,"h2",36)(39,"strong"),e._uU(40,"School"),e.qZA()(),e.TgZ(41,"h1"),e._uU(42),e.qZA(),e.TgZ(43,"h2"),e._uU(44),e.qZA()()()()(),e.YNc(45,E,4,0,"ion-footer",40)}if(2&i){const t=e.MAs(15),n=e.oxw();e.xp6(10),e.Oqu(e.xi3(11,11,null==n.current?null:n.current.dateRequested,"MMM dd, yyyy")),e.xp6(3),e.Q6J("ngIf","APPROVED"===(null==n.current?null:n.current.status))("ngIfElse",t),e.xp6(10),e.Oqu(null==n.current?null:n.current.status),e.xp6(1),e.Q6J("button","APPROVED"===(null==n.current?null:n.current.status)),e.xp6(8),e.Oqu(null==n.current||null==n.current.student?null:n.current.student.orgStudentId),e.xp6(2),e.Oqu(null==n.current||null==n.current.student?null:n.current.student.fullName),e.xp6(1),e.Q6J("button","APPROVED"===(null==n.current?null:n.current.status)),e.xp6(7),e.Oqu(null==n.current||null==n.current.school?null:n.current.school.schoolName),e.xp6(2),e.Oqu(null==n.current||null==n.current.school?null:n.current.school.schoolAddress),e.xp6(1),e.Q6J("ngIf","PENDING"===(null==n.current?null:n.current.status))}}function U(i,o){1&i&&(e.TgZ(0,"div",42),e._UZ(1,"ion-icon",43),e.TgZ(2,"h1"),e._uU(3,"No Request to show"),e.qZA()())}function L(i,o){1&i&&(e.TgZ(0,"div",18)(1,"ion-card",19)(2,"ion-card-content")(3,"ion-item",44)(4,"ion-label")(5,"div",21),e._UZ(6,"ion-skeleton-text",45),e.TgZ(7,"div",46)(8,"h2",26),e._UZ(9,"ion-skeleton-text",47),e.qZA(),e.TgZ(10,"h1"),e._UZ(11,"ion-skeleton-text",47),e.qZA()()(),e.TgZ(12,"h2"),e._UZ(13,"ion-skeleton-text",48),e.qZA()()()()()()),2&i&&(e.xp6(6),e.Q6J("animated",!0),e.xp6(3),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}const w=function(){return[0,.8,1]};class g{linkStudentRequestService;authService;alertController;actionSheetController;pageLoaderService;modalCtrl;animationService;storageService;requestInfoModal;isLoading=!1;isSubmitting=!1;modal;pageIndex=0;pageSize=10;limit=10;total=0;myRequests=[];current;ionRefresher;constructor(o,t,n,r,s,u,_,N){this.linkStudentRequestService=o,this.authService=t,this.alertController=n,this.actionSheetController=r,this.pageLoaderService=s,this.modalCtrl=u,this.animationService=_,this.storageService=N,this.isAuthenticated&&this.initRequests()}get isAuthenticated(){const o=this.storageService.getLoginUser();return o&&o?.parentCode&&o?.user&&o?.user?.userId}ngOnInit(){}initRequests(){this.isLoading=!0;const o=this.storageService.getLoginUser();this.linkStudentRequestService.getByAdvanceSearch({order:{linkStudentRequestCode:"DESC"},columnDef:[{apiNotation:"requestedByParent.parentCode",filter:o.parentCode,type:"precise"}],pageIndex:this.pageIndex,pageSize:this.pageSize}).subscribe(t=>{this.isLoading=!1,this.myRequests=[...this.myRequests,...t.data.results],this.total=t.data.total,console.log(this.myRequests),this.ionRefresher&&this.ionRefresher.complete()})}loadMore(){var o=this;return(0,l.Z)(function*(){o.pageIndex=o.pageIndex+1,yield o.initRequests()})()}doRefresh(){var o=this;return(0,l.Z)(function*(){try{if(o.isLoading)return;o.pageIndex=0,o.pageSize=10,o.myRequests=[],yield o.initRequests()}catch{o.ionRefresher&&o.ionRefresher.complete(),yield o.presentAlert({header:"Try again!",message:"Error loading",buttons:["OK"]})}})()}onCancel(){var o=this;return(0,l.Z)(function*(){const t=yield o.actionSheetController.create({cssClass:"app-action-sheet",header:"Do you want to cancel request?",buttons:[{text:"Yes?",handler:(n=(0,l.Z)(function*(){t.dismiss();const r=o.storageService.getLoginUser();o.cancel(o.current.linkStudentRequestCode,{updatedByUserId:r.user.userId})}),function(){return n.apply(this,arguments)})},{text:"No",handler:function(){var n=(0,l.Z)(function*(){t.dismiss()});return function(){return n.apply(this,arguments)}}()}]});var n;yield t.present()})()}cancel(o,t){var n=this;return(0,l.Z)(function*(){try{n.isSubmitting=!0,yield n.pageLoaderService.open("Checking please wait..."),n.linkStudentRequestService.cancel(o,t).subscribe(function(){var r=(0,l.Z)(function*(s){if(console.log(s),n.pageLoaderService.close(),s.success){console.log(s),n.isSubmitting=!1;const u=n.myRequests.findIndex(_=>_.linkStudentRequestId===s.data.linkStudentRequestId);n.myRequests[u]=s.data,n.current=s.data,yield n.presentAlert({header:"Done!",message:"Request is now cancelled!",buttons:["OK"]})}else n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(s.message)?s.message[0]:s.message,buttons:["OK"]})});return function(s){return r.apply(this,arguments)}}(),function(){var r=(0,l.Z)(function*(s){n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(s.message)?s.message[0]:s.message,buttons:["OK"]})});return function(s){return r.apply(this,arguments)}}())}catch(r){n.pageLoaderService.close(),n.isSubmitting=!1,yield n.presentAlert({header:"Try again!",message:Array.isArray(r.message)?r.message[0]:r.message,buttons:["OK"]})}})()}close(){this.modal.dismiss(null,"cancel")}presentAlert(o){var t=this;return(0,l.Z)(function*(){yield(yield t.alertController.create(o)).present()})()}static \u0275fac=function(t){return new(t||g)(e.Y36(m.e),e.Y36(f.e),e.Y36(a.Br),e.Y36(a.BX),e.Y36(h.p),e.Y36(a.IN),e.Y36(M.Y),e.Y36(x.V))};static \u0275cmp=e.Xpm({type:g,selectors:[["app-my-link-student-requests"]],viewQuery:function(t,n){if(1&t&&(e.Gf(P,5),e.Gf(a.nJ,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.requestInfoModal=r.first),e.iGM(r=e.CRH())&&(n.ionRefresher=r.first)}},decls:23,vars:5,consts:[["no-border","","no-shadow",""],["mode","md"],["slot","start",2,"width","48px"],[1,"ion-text-center"],["slot","end"],[3,"click"],["name","close-sharp","color","primary",2,"font-size","2em!important"],["slot","fixed",1,"refresher-custom",3,"ionRefresh"],[1,"content"],[1,"title"],[1,"request","ion-padding"],[4,"ngIf","ngIfElse"],[1,"request-info-modal",3,"initialBreakpoint","breakpoints"],["requestInfoModal",""],["noRequestTemplate",""],["loadingTemplate",""],["class","row",4,"ngFor","ngForOf"],["fill","clear","size","small","expand","full",3,"click",4,"ngIf"],[1,"row"],["mode","ios"],["button","","lines","none","detail","false",3,"click"],[2,"display","flex","flex-direction","row","align-items","center","gap","10px"],["aria-hidden","true","color","primary","name","checkmark-circle","slot","start",4,"ngIf","ngIfElse"],["notApproved",""],["closed",""],[2,"display","flex","flex-direction","column"],[2,"margin-bottom","10px"],["aria-hidden","true","color","primary","name","checkmark-circle","slot","start"],["aria-hidden","true","color","warning","name","time","slot","start",4,"ngIf","ngIfElse"],["aria-hidden","true","color","warning","name","time","slot","start"],["aria-hidden","true","color","danger","slot","start",3,"name"],["fill","clear","size","small","expand","full",3,"click"],[1,"ion-padding"],["lines","none","detail","false"],["currentNotApproved",""],["currentClosed",""],[2,"opacity","0.7"],["lines","none","detail","false",3,"button"],["aria-hidden","true","color","primary","name","person","slot","start"],["aria-hidden","true","color","primary","name","business","slot","start"],[4,"ngIf"],["mode","md","expand","full","shape","round","size","large","fill","outline","color","danger",3,"click"],[1,"no-result"],["name","document-outline"],["button","false","lines","none","detail","false"],[2,"min-height","70px","min-width","70px","max-width","70px",3,"animated"],[2,"display","flex","flex-direction","column","width","100%"],[2,"height","25px","width","100%",3,"animated"],[2,"height","25px",3,"animated"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1),e._UZ(2,"div",2)(3,"ion-title",3),e.TgZ(4,"ion-buttons",4)(5,"ion-button",5),e.NdJ("click",function(){return n.close()}),e._UZ(6,"ion-icon",6),e.qZA()()()(),e.TgZ(7,"ion-content",1)(8,"ion-refresher",7),e.NdJ("ionRefresh",function(){return n.doRefresh()}),e._UZ(9,"ion-refresher-content"),e.qZA(),e.TgZ(10,"div",8)(11,"div",9)(12,"h1"),e._uU(13,"My Request"),e.qZA()(),e.TgZ(14,"div",10),e.YNc(15,R,2,2,"ng-container",11),e.qZA()(),e.TgZ(16,"ion-modal",12,13),e.YNc(18,I,46,14,"ng-template"),e.qZA(),e.YNc(19,U,4,0,"ng-template",null,14,e.W1O),e.YNc(21,L,14,4,"ng-template",null,15,e.W1O),e.qZA()),2&t){const r=e.MAs(22);e.xp6(15),e.Q6J("ngIf",!n.isLoading)("ngIfElse",r),e.xp6(1),e.Q6J("initialBreakpoint","PENDING"===(null==n.current?null:n.current.status)?1:.8)("breakpoints",e.DdM(4,w))}},dependencies:[d.sg,d.O5,a.YG,a.Sm,a.PM,a.FN,a.W2,a.fr,a.Gu,a.gu,a.Ie,a.Q$,a.nJ,a.Wo,a.CK,a.wd,a.sr,a.ki,d.uU],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], span[_ngcontent-%COMP%], p[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin:0}ion-header[_ngcontent-%COMP%]:after{background-image:none;background:transparent}ion-header[_ngcontent-%COMP%]     .profile-toolbar{padding:10px;box-sizing:border-box;height:64px;width:64px}ion-header[_ngcontent-%COMP%]     .profile-toolbar ion-avatar{width:100%;height:100%}ion-header[_ngcontent-%COMP%]     .profile-toolbar ion-avatar img{object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75;border-radius:100%;display:flex;flex-direction:column;overflow:hidden;width:100%;height:100%}ion-header[_ngcontent-%COMP%]:after{background-image:none}  ion-footer ion-toolbar   .footer-controls{width:100%;margin-right:10px}  ion-footer ion-toolbar   .profile-toolbar{box-sizing:border-box;height:48px;min-width:48px}  ion-footer ion-toolbar   .profile-toolbar ion-avatar{width:100%;height:100%}  ion-footer ion-toolbar   .profile-toolbar ion-avatar img{object-position:center;object-fit:contain;box-shadow:0 0 10px #7a7a7a75;border-radius:100%;display:flex;flex-direction:column;overflow:hidden;width:100%;height:100%}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{margin:0}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%!important}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{padding:30px;position:sticky;top:0;z-index:99;background-color:#fff}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{font-size:2rem!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:30px!important;flex-grow:1}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;width:100%!important;flex-direction:column}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card{margin:0!important;border-radius:20px!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item::part(native){padding:0!important;background-color:transparent}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item .title, .content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item .placeholder{opacity:.5}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item ion-label{display:flex;margin:0!important;flex-direction:column;gap:5px!important;white-space:break-spaces!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item ion-label .desc{opacity:.6;font-weight:600}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]     ion-card   ion-item ion-icon{font-size:3rem}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]   .ion-card-content[_ngcontent-%COMP%]{padding:0!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]   .ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{padding:20px!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]   .no-result[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;align-self:center;padding:20px;align-items:center;justify-content:center;border-radius:10px;flex-direction:column;row-gap:5px!important}.content[_ngcontent-%COMP%]   .request[_ngcontent-%COMP%]   .no-result[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3rem!important}.request-info-modal[_ngcontent-%COMP%]{--width: 100%}.request-info-modal[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem!important}.request-info-modal[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{white-space:normal!important;overflow:visible}ion-footer[_ngcontent-%COMP%]{display:flex}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;padding:5px 10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;flex-grow:1;font-size:18px;width:100%;margin:0!important}"]})}}}]);