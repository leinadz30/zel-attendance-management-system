"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7719],{76:(E,C,o)=>{o.d(C,{GW:()=>a,dk:()=>t,oK:()=>u});var u=(()=>{return(e=u||(u={})).Prompt="PROMPT",e.Camera="CAMERA",e.Photos="PHOTOS",u;var e})(),a=(()=>{return(e=a||(a={})).Rear="REAR",e.Front="FRONT",a;var e})(),t=(()=>{return(e=t||(t={})).Uri="uri",e.Base64="base64",e.DataUrl="dataUrl",t;var e})()},5045:(E,C,o)=>{o.d(C,{n:()=>u});class u{isErrorState(t,e){return!(!t?.invalid||!t?.parent?.dirty)||!(!t?.parent?.invalid||!t?.parent?.dirty)}}},3013:(E,C,o)=>{o.d(C,{l:()=>v});var u=o(1086),a=o(2868),t=o(7221),e=o(2340),_=o(4650),A=o(529),f=o(9709);class v{http;appconfig;constructor(r,g){this.http=r,this.appconfig=g}getByAdvanceSearch(r){return this.http.post(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByAdvanceSearch,r).pipe((0,a.b)(g=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}getByCode(r){return this.http.get(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByCode+r).pipe((0,a.b)(g=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}create(r){return this.http.post(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.create,r).pipe((0,a.b)(g=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}updateProfile(r,g){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfile+r,g).pipe((0,a.b)(y=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}resetPassword(r,g){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.resetPassword+r,g).pipe((0,a.b)(y=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}updateProfilePicture(r,g){return this.http.put(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfilePicture+r,g).pipe((0,a.b)(y=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}delete(r){return this.http.delete(e.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.delete+r).pipe((0,a.b)(g=>this.log("parents")),(0,t.K)(this.handleError("parents",[])))}handleError(r="operation",g){return y=>(this.log(`${r} failed: ${Array.isArray(y.error.message)?y.error.message[0]:y.error.message}`),(0,u.of)(y.error))}log(r){console.log(r)}static \u0275fac=function(g){return new(g||v)(_.LFG(A.eN),_.LFG(f._))};static \u0275prov=_.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})}},1800:(E,C,o)=>{o.d(C,{t:()=>e});var u=o(2340),a=o(4650),t=o(603);class e{modal;version;constructor(){this.version=`${u.N.version}(${u.N.build})`}ngOnInit(){}close(){this.modal.dismiss(null,"cancel")}static \u0275fac=function(f){return new(f||e)};static \u0275cmp=a.Xpm({type:e,selectors:[["app-about"]],decls:16,vars:1,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","arrow-back-sharp","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],[1,"container"],[1,"image-holder"],["src","../../../assets/img/app_banner_bg.png"],[1,"description"]],template:function(f,v){1&f&&(a.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),a.NdJ("click",function(){return v.close()}),a._UZ(4,"ion-icon",4),a.qZA()(),a.TgZ(5,"ion-title",5)(6,"h1",6),a._uU(7,"About ZamsConnect"),a.qZA()(),a._UZ(8,"div",7),a.qZA()(),a.TgZ(9,"ion-content",1)(10,"div",8)(11,"div",9),a._UZ(12,"img",10),a.qZA(),a.TgZ(13,"div",11)(14,"h2"),a._uU(15),a.qZA()()()()),2&f&&(a.xp6(15),a.hij("Current version ",v.version,""))},dependencies:[t.YG,t.Sm,t.W2,t.Gu,t.gu,t.wd,t.sr],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;row-gap:10px!important}.container[_ngcontent-%COMP%]   .image-holder[_ngcontent-%COMP%]{display:flex;max-width:100px!important;border-radius:50px;overflow:hidden}.container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:flex}"]})}},7826:(E,C,o)=>{o.d(C,{f:()=>l});var u=o(5861),a=o(4006),t=o(5045),e=o(4650),_=o(263),A=o(3013),f=o(603),v=o(7956),S=o(3746),r=o(6895),g=o(7392),y=o(9549),M=o(4144);function Z(s,n){1&s&&(e.TgZ(0,"span",22),e._uU(1," Please enter your password "),e.qZA())}function h(s,n){1&s&&(e.TgZ(0,"span",22),e._uU(1," Password is incorrect "),e.qZA())}function m(s,n){1&s&&(e.TgZ(0,"span",22),e._uU(1," Please enter new password "),e.qZA())}function p(s,n){1&s&&(e.TgZ(0,"span",22),e._uU(1," Confirm Password is required "),e.qZA())}function i(s,n){1&s&&(e.TgZ(0,"span",22),e._uU(1," Password not match "),e.qZA())}class l{authService;parentsService;formBuilder;actionSheetController;alertController;pageLoaderService;storageService;modal;currentUser;changePasswordForm;activeAditionalBackdrop=!1;isSubmitting=!1;matcher=new t.n;error;constructor(n,c,d,P,b,O,T){this.authService=n,this.parentsService=c,this.formBuilder=d,this.actionSheetController=P,this.alertController=b,this.pageLoaderService=O,this.storageService=T,this.currentUser=this.storageService.getLoginUser()}get formData(){return this.changePasswordForm.value}get errorControls(){return this.changePasswordForm.controls}get notSameValueErrorHandler(){return this.changePasswordForm.errors}ngOnInit(){this.changePasswordForm=this.formBuilder.group({currentPassword:[null,a.kI.required],password:[null,a.kI.required],confirmPassword:""},{validators:this.checkPasswords})}checkPasswords=n=>n.get("password").value===n.get("confirmPassword").value?null:{notSame:!0};onSubmit(){var n=this;return(0,u.Z)(function*(){const c=n.formData;if(n.changePasswordForm.valid)try{const d=yield n.actionSheetController.create({cssClass:"app-action-sheet",header:"Are you sure you want to change your password?",buttons:[{text:"Yes?",handler:(P=(0,u.Z)(function*(){d.dismiss(),n.save(c)}),function(){return P.apply(this,arguments)})},{text:"No",handler:function(){var P=(0,u.Z)(function*(){d.dismiss()});return function(){return P.apply(this,arguments)}}()}]});yield d.present()}catch(d){n.isSubmitting=!1,yield n.pageLoaderService.close(),yield n.presentAlert({header:"Try again!",message:Array.isArray(d.message)?d.message[0]:d.message,buttons:["OK"]})}var P})()}save(n){var c=this;return(0,u.Z)(function*(){try{yield c.pageLoaderService.open("Saving..."),c.isSubmitting=!0;const d=yield c.authService.login({userName:c.currentUser.user.userName,password:n.currentPassword}).toPromise();if(d.success){const P=yield c.parentsService.resetPassword(c.currentUser.parentCode,n).toPromise();P.success?(yield c.pageLoaderService.close(),yield c.presentAlert({header:"Password changed!",buttons:["OK"]}),c.isSubmitting=!1,c.modal.dismiss(P.data,"confirm")):(c.isSubmitting=!1,yield c.pageLoaderService.close(),c.error=Array.isArray(P.message)?P.message[0]:P.message,yield c.presentAlert({header:"Try again!",message:c.error,buttons:["OK"]}))}else c.isSubmitting=!1,c.error=Array.isArray(d.message)?d.message[0]:d.message,console.log(d.message),c.changePasswordForm.controls.currentPassword.setErrors({incorrectPassword:!0}),c.changePasswordForm.controls.currentPassword.markAllAsTouched()}catch(d){c.isSubmitting=!1,yield c.pageLoaderService.close(),c.error=Array.isArray(d.message)?d.message[0]:d.message,yield c.presentAlert({header:"Try again!",message:c.error,buttons:["OK"]})}})()}close(){this.modal.dismiss(null,"cancel")}presentAlert(n){var c=this;return(0,u.Z)(function*(){return yield(yield c.alertController.create(n)).present()})()}static \u0275fac=function(c){return new(c||l)(e.Y36(_.e),e.Y36(A.l),e.Y36(a.qu),e.Y36(f.BX),e.Y36(f.Br),e.Y36(v.p),e.Y36(S.V))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-password-and-security"]],decls:45,vars:12,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","arrow-back-sharp","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],[1,"ion-padding"],["id","changePasswordForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","password","placeholder","Current Password","formControlName","currentPassword","autocomplete","new-currentPassword"],["currentPassword",""],["matSuffix","",1,"icon-right",2,"cursor","pointer",3,"click"],["class","error",4,"ngIf"],["matInput","","type","password","placeholder","Password","formControlName","password","autocomplete","new-password"],["password",""],["matInput","","type","password","placeholder","Confirm password","formControlName","confirmPassword","autocomplete","new-confirmPassword",3,"errorStateMatcher"],["confirmPassword",""],["mode","md","type","submit","expand","full","shape","round","size","large","color","primary","form","changePasswordForm",3,"disabled"],[1,"error"]],template:function(c,d){if(1&c){const P=e.EpF();e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),e.NdJ("click",function(){return d.close()}),e._UZ(4,"ion-icon",4),e.qZA()(),e.TgZ(5,"ion-title",5)(6,"h1",6),e._uU(7,"Password and security"),e.qZA()(),e._UZ(8,"div",7),e.qZA()(),e.TgZ(9,"ion-content",8)(10,"form",9),e.NdJ("ngSubmit",function(){return!!d.changePasswordForm.valid&&d.onSubmit()}),e.TgZ(11,"fieldset",10)(12,"div",11)(13,"mat-label"),e._uU(14,"Current Password"),e.qZA(),e.TgZ(15,"mat-form-field",12),e._UZ(16,"input",13,14),e.TgZ(18,"mat-icon",15),e.NdJ("click",function(){e.CHM(P);const O=e.MAs(17);return e.KtG(O.type="password"===O.type?"text":"password")}),e._uU(19),e.qZA()(),e.YNc(20,Z,2,0,"span",16),e.YNc(21,h,2,0,"span",16),e.qZA(),e.TgZ(22,"div",11)(23,"mat-label"),e._uU(24,"New Password"),e.qZA(),e.TgZ(25,"mat-form-field",12),e._UZ(26,"input",17,18),e.TgZ(28,"mat-icon",15),e.NdJ("click",function(){e.CHM(P);const O=e.MAs(27);return e.KtG(O.type="password"===O.type?"text":"password")}),e._uU(29),e.qZA()(),e.YNc(30,m,2,0,"span",16),e.qZA(),e.TgZ(31,"div",11)(32,"mat-label"),e._uU(33,"Confirm Password"),e.qZA(),e.TgZ(34,"mat-form-field",12),e._UZ(35,"input",19,20),e.TgZ(37,"mat-icon",15),e.NdJ("click",function(){e.CHM(P);const O=e.MAs(36);return e.KtG(O.type="password"===O.type?"text":"password")}),e._uU(38),e.qZA()(),e.YNc(39,p,2,0,"span",16),e.YNc(40,i,2,0,"span",16),e.qZA()()()(),e.TgZ(41,"ion-footer")(42,"ion-toolbar",1)(43,"ion-button",21),e._uU(44," Update password "),e.qZA()()()}if(2&c){const P=e.MAs(17),b=e.MAs(27),O=e.MAs(36);e.xp6(10),e.Q6J("formGroup",d.changePasswordForm),e.xp6(1),e.Q6J("disabled",d.isSubmitting),e.xp6(8),e.Oqu("password"===P.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",d.errorControls.currentPassword.touched&&d.errorControls.currentPassword.errors&&d.errorControls.currentPassword.errors.required),e.xp6(1),e.Q6J("ngIf",d.errorControls.currentPassword.touched&&d.errorControls.currentPassword.errors&&d.errorControls.currentPassword.errors.incorrectPassword),e.xp6(8),e.Oqu("password"===b.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",d.errorControls.password.touched&&d.errorControls.password.errors&&d.errorControls.password.errors.required),e.xp6(5),e.Q6J("errorStateMatcher",d.matcher),e.xp6(3),e.Oqu("password"===O.type?"visibility":"visibility_off"),e.xp6(1),e.Q6J("ngIf",d.errorControls.confirmPassword.touched&&d.errorControls.confirmPassword.errors&&d.errorControls.confirmPassword.errors.required),e.xp6(1),e.Q6J("ngIf",d.errorControls.confirmPassword.touched&&d.notSameValueErrorHandler&&d.notSameValueErrorHandler.notSame),e.xp6(3),e.Q6J("disabled",!d.changePasswordForm.valid||d.isSubmitting)}},dependencies:[r.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,f.YG,f.Sm,f.W2,f.fr,f.Gu,f.gu,f.wd,f.sr,g.Hw,y.KE,y.hX,y.R9,M.Nt],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}ion-footer[_ngcontent-%COMP%]{display:flex}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;padding:5px 10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;flex-grow:1;font-size:18px;width:100%;margin:0!important}"]})}},4787:(E,C,o)=>{o.d(C,{B:()=>M});var u=o(5861),a=o(4006),t=o(4650),e=o(3013),_=o(603),A=o(7956),f=o(3746),v=o(6895),S=o(9549),r=o(4144);function g(Z,h){1&Z&&(t.TgZ(0,"span",17),t._uU(1," Full Name is required "),t.qZA())}function y(Z,h){1&Z&&(t.TgZ(0,"span",17),t._uU(1," Mobile number is required "),t.qZA())}class M{parentsService;formBuilder;alertController;pageLoaderService;storageService;actionSheetController;modal;currentUser;editProfileForm;activeAditionalBackdrop=!1;isSubmitting=!1;constructor(h,m,p,i,l,s){this.parentsService=h,this.formBuilder=m,this.alertController=p,this.pageLoaderService=i,this.storageService=l,this.actionSheetController=s,this.currentUser=this.storageService.getLoginUser()}get formData(){return{...this.editProfileForm.value,parentId:this.currentUser.parentId}}get isFormDirty(){return this.currentUser.fullName!==this.formData.fullName||this.currentUser.mobileNumber!==this.formData.mobileNumber}get errorControls(){return this.editProfileForm.controls}ngOnInit(){this.editProfileForm=this.formBuilder.group({fullName:new a.NI(this.currentUser.fullName,a.kI.required),mobileNumber:new a.NI(this.currentUser.mobileNumber,a.kI.required)})}onSubmit(){var h=this;return(0,u.Z)(function*(){const m=h.formData;if(h.editProfileForm.valid)try{const p=yield h.actionSheetController.create({cssClass:"app-action-sheet",header:"Do you want to update profile settings?",buttons:[{text:"Yes?",handler:(i=(0,u.Z)(function*(){p.dismiss(),h.save(m)}),function(){return i.apply(this,arguments)})},{text:"No",handler:function(){var i=(0,u.Z)(function*(){p.dismiss()});return function(){return i.apply(this,arguments)}}()}]});yield p.present()}catch(p){h.isSubmitting=!1,yield h.pageLoaderService.close(),yield h.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]})}var i})()}save(h){var m=this;return(0,u.Z)(function*(){try{yield m.pageLoaderService.open("Saving..."),m.isSubmitting=!0,m.parentsService.updateProfile(m.currentUser.parentCode,h).subscribe(function(){var p=(0,u.Z)(function*(i){i.success?(yield m.pageLoaderService.close(),yield m.presentAlert({header:"Saved!",buttons:["OK"]}),m.isSubmitting=!1,m.currentUser.fullName=i.data.fullName,m.currentUser.mobileNumber=i.data.mobileNumber,m.storageService.saveLoginUser(m.currentUser),m.modal.dismiss(i.data,"confirm")):(m.isSubmitting=!1,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]}))});return function(i){return p.apply(this,arguments)}}(),function(){var p=(0,u.Z)(function*(i){m.isSubmitting=!1,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Try again!",message:Array.isArray(i.message)?i.message[0]:i.message,buttons:["OK"]})});return function(i){return p.apply(this,arguments)}}())}catch(p){m.isSubmitting=!1,yield m.pageLoaderService.close(),yield m.presentAlert({header:"Try again!",message:Array.isArray(p.message)?p.message[0]:p.message,buttons:["OK"]})}})()}close(){this.modal.dismiss(null,"cancel")}presentAlert(h){var m=this;return(0,u.Z)(function*(){return yield(yield m.alertController.create(h)).present()})()}static \u0275fac=function(m){return new(m||M)(t.Y36(e.l),t.Y36(a.qu),t.Y36(_.Br),t.Y36(A.p),t.Y36(f.V),t.Y36(_.BX))};static \u0275cmp=t.Xpm({type:M,selectors:[["app-profile-settings"]],decls:28,vars:5,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","arrow-back-sharp","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],["mode","md",1,"ion-padding"],["id","editProfileForm",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"form-field-group"],["appearance","outline"],["matInput","","type","text","placeholder","Name","formControlName","fullName","autocomplete","new-fullName"],["class","error",4,"ngIf"],["matInput","","type","text","placeholder","Mobile number","formControlName","mobileNumber","autocomplete","new-mobileNumber"],["mode","md","type","submit","expand","full","shape","round","size","large","color","primary","form","editProfileForm",3,"disabled"],[1,"error"]],template:function(m,p){1&m&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),t.NdJ("click",function(){return p.close()}),t._UZ(4,"ion-icon",4),t.qZA()(),t.TgZ(5,"ion-title",5)(6,"h1",6),t._uU(7,"Profile settings"),t.qZA()(),t._UZ(8,"div",7),t.qZA()(),t.TgZ(9,"ion-content",8)(10,"form",9),t.NdJ("ngSubmit",function(){return!!p.editProfileForm.valid&&p.onSubmit()}),t.TgZ(11,"fieldset",10)(12,"div",11)(13,"mat-label"),t._uU(14,"Name"),t.qZA(),t.TgZ(15,"mat-form-field",12),t._UZ(16,"input",13),t.qZA(),t.YNc(17,g,2,0,"span",14),t.qZA(),t.TgZ(18,"div",11)(19,"mat-label"),t._uU(20,"Mobile number"),t.qZA(),t.TgZ(21,"mat-form-field",12),t._UZ(22,"input",15),t.qZA(),t.YNc(23,y,2,0,"span",14),t.qZA()()()(),t.TgZ(24,"ion-footer")(25,"ion-toolbar",1)(26,"ion-button",16),t._uU(27," Update "),t.qZA()()()),2&m&&(t.xp6(10),t.Q6J("formGroup",p.editProfileForm),t.xp6(1),t.Q6J("disabled",p.isSubmitting),t.xp6(6),t.Q6J("ngIf",p.errorControls.fullName.touched&&p.errorControls.fullName.errors&&p.errorControls.fullName.errors.required),t.xp6(6),t.Q6J("ngIf",p.errorControls.mobileNumber.touched&&p.errorControls.mobileNumber.errors&&p.errorControls.mobileNumber.errors.required),t.xp6(3),t.Q6J("disabled",!p.isFormDirty||p.isSubmitting))},dependencies:[v.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,_.YG,_.Sm,_.W2,_.fr,_.Gu,_.gu,_.wd,_.sr,S.KE,S.hX,r.Nt],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}ion-footer[_ngcontent-%COMP%]{display:flex}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;padding:5px 10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;flex-grow:1;font-size:18px;width:100%;margin:0!important}"]})}},7719:(E,C,o)=>{o.d(C,{N:()=>m});var u=o(5861),a=o(7826),t=o(4787),e=o(2340),_=o(7423);const A=(0,_.fo)("Filesystem",{web:()=>o.e(6364).then(o.bind(o,6364)).then(p=>new p.FilesystemWeb)});var f=o(76);const v=(0,_.fo)("Camera",{web:()=>o.e(3954).then(o.bind(o,3954)).then(p=>new p.CameraWeb)});var S=o(1800),r=o(4650),g=o(603),y=o(3013),M=o(9773),Z=o(263),h=o(3746);class m{actionSheetController;platform;parentsService;router;authService;modalCtrl;storageService;alertController;currentUser;profilePicSource;modal;routerOutlet;isSubmitting=!1;version;constructor(i,l,s,n,c,d,P,b){this.actionSheetController=i,this.platform=l,this.parentsService=s,this.router=n,this.authService=c,this.modalCtrl=d,this.storageService=P,this.alertController=b,this.currentUser=this.storageService.getLoginUser(),this.version=`${e.N.version}(${e.N.build})`}ngOnInit(){}onSettingsMenuClick(i){var l=this;return(0,u.Z)(function*(){let s=null;switch(i){case"profile-settings":s=yield l.modalCtrl.create({component:t.B,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,mode:"ios",componentProps:{modal:s}}),s.onWillDismiss().then(n=>{n.data&&"confirm"===n.role&&(l.currentUser=l.storageService.getLoginUser())}),s.present();break;case"password-and-security":s=yield l.modalCtrl.create({component:a.f,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,mode:"ios",componentProps:{modal:s}}),s.present();break;case"about":s=yield l.modalCtrl.create({component:S.t,cssClass:"modal-fullscreen",backdropDismiss:!1,canDismiss:!0,mode:"ios",componentProps:{modal:s}}),s.present()}})()}signout(){var i=this;return(0,u.Z)(function*(){const l=yield i.actionSheetController.create({cssClass:"app-action-sheet",buttons:[{text:"Logout?",handler:(s=(0,u.Z)(function*(){const n=yield i.actionSheetController.create({cssClass:"app-action-sheet",header:"Do you want to logout?",buttons:[{text:"Yes?",handler:(c=(0,u.Z)(function*(){i.authService.logout(),n.dismiss(),l.dismiss()}),function(){return c.apply(this,arguments)})},{text:"No",handler:function(){var c=(0,u.Z)(function*(){n.dismiss(),l.dismiss()});return function(){return c.apply(this,arguments)}}()}]});var c;yield n.present()}),function(){return s.apply(this,arguments)})},{text:"Cancel",handler:function(){var s=(0,u.Z)(function*(){l.dismiss()});return function(){return s.apply(this,arguments)}}()}]});var s;yield l.present()})()}ionViewWillEnter(){}close(){this.modal.dismiss(null,"cancel")}toggleDarkMode(){const i=window.matchMedia("(prefers-color-scheme: dark)");this.toggleDarkTheme(i.matches),i.addListener(l=>this.toggleDarkTheme(l.matches))}toggleDarkTheme(i){document.body.classList.toggle("dark",i)}onChangeProfilePic(){var i=this;return(0,u.Z)(function*(){const l=yield i.actionSheetController.create({cssClass:"sched-card-action-sheet",buttons:[{text:"Camera",handler:(s=(0,u.Z)(function*(){const n=yield v.getPhoto({quality:90,allowEditing:!1,resultType:f.dk.Uri,source:f.oK.Camera});if(n){const c=yield i.readAsBase64(n);i.profilePicSource=c,yield i.saveProfilePicture({userId:i.currentUser.user.userId,userProfilePic:{fileName:`profile-sample-name.${n.format}`,data:c}})}l.dismiss()}),function(){return s.apply(this,arguments)})},{text:"Gallery",handler:function(){var s=(0,u.Z)(function*(){const n=yield v.getPhoto({quality:90,allowEditing:!1,resultType:f.dk.Uri,source:f.oK.Photos});if(n){const c=yield i.readAsBase64(n);i.profilePicSource=c,yield i.saveProfilePicture({userId:i.currentUser.user.userId,userProfilePic:{fileName:`profile-sample-name.${n.format}`,data:c}})}l.dismiss()});return function(){return s.apply(this,arguments)}}()},{text:"Cancel",handler:function(){var s=(0,u.Z)(function*(){l.dismiss()});return function(){return s.apply(this,arguments)}}()}]});var s;yield l.present()})()}readAsBase64(i){var l=this;return(0,u.Z)(function*(){if(l.platform.is("hybrid"))return(yield A.readFile({path:i.path})).data;{const n=yield(yield fetch(i.webPath)).blob();return(yield l.convertBlobToBase64(n)).split(",")[1]}})()}convertBlobToBase64=i=>new Promise((l,s)=>{const n=new FileReader;n.onerror=s,n.onload=()=>{l(n.result)},n.readAsDataURL(i)});profilePicErrorHandler(i){i.target.src="../../../assets/img/profile-not-found.svg"}saveProfilePicture(i){var l=this;return(0,u.Z)(function*(){try{l.isSubmitting=!0,l.parentsService.updateProfilePicture(l.currentUser.parentCode,i).subscribe(function(){var s=(0,u.Z)(function*(n){console.log(n),n.success?(console.log(n),l.isSubmitting=!1,l.currentUser.userProfilePic=n.data.user.userProfilePic.file.url,l.storageService.saveLoginUser(l.currentUser)):(l.isSubmitting=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(n.message)?n.message[0]:n.message,buttons:["OK"]}))});return function(n){return s.apply(this,arguments)}}(),function(){var s=(0,u.Z)(function*(n){l.isSubmitting=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(n.message)?n.message[0]:n.message,buttons:["OK"]})});return function(n){return s.apply(this,arguments)}}())}catch(s){l.isSubmitting=!1,yield l.presentAlert({header:"Try again!",message:Array.isArray(s.message)?s.message[0]:s.message,buttons:["OK"]})}})()}presentAlert(i){var l=this;return(0,u.Z)(function*(){return yield(yield l.alertController.create(i)).present()})()}static \u0275fac=function(l){return new(l||m)(r.Y36(g.BX),r.Y36(g.t4),r.Y36(y.l),r.Y36(M.F0),r.Y36(Z.e),r.Y36(g.IN),r.Y36(h.V),r.Y36(g.Br))};static \u0275cmp=r.Xpm({type:m,selectors:[["app-settings"]],decls:41,vars:5,consts:[["no-border","","no-shadow","","mode","md"],["mode","md"],["slot","start"],[3,"click"],["name","arrow-back-sharp","color","primary",2,"font-size","2em!important"],[1,"ion-text-center"],[2,"margin","0!important"],["slot","end",2,"width","48px"],[1,"content"],[1,"row","profile"],[1,"col","avatar"],["id","profilePicture",3,"src","click","error"],[1,"col"],[1,"row","name"],[1,"row",2,"display","flex"],["lines","none",1,"nav-list"],["button","true",3,"click"],["slot","start","name","person"],["slot","start","name","shield-checkmark"],["slot","start","name","information-circle"],["slot","start","name","exit","color","danger"],["color","danger"]],template:function(l,s){1&l&&(r.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),r.NdJ("click",function(){return s.close()}),r._UZ(4,"ion-icon",4),r.qZA()(),r.TgZ(5,"ion-title",5)(6,"h1",6),r._uU(7,"Settings"),r.qZA()(),r._UZ(8,"div",7),r.qZA()(),r.TgZ(9,"ion-content",1)(10,"div",8)(11,"div",9)(12,"div",10)(13,"ion-avatar")(14,"img",11),r.NdJ("click",function(){return s.onChangeProfilePic()})("error",function(c){return s.profilePicErrorHandler(c)}),r.qZA()()(),r.TgZ(15,"div",12)(16,"div",13)(17,"h1"),r._uU(18),r.qZA()()()(),r.TgZ(19,"div",14)(20,"ion-list",15)(21,"ion-item",16),r.NdJ("click",function(){return s.onSettingsMenuClick("profile-settings")}),r._UZ(22,"ion-icon",17),r.TgZ(23,"ion-label")(24,"h1"),r._uU(25,"Profile Settings"),r.qZA()()(),r.TgZ(26,"ion-item",16),r.NdJ("click",function(){return s.onSettingsMenuClick("password-and-security")}),r._UZ(27,"ion-icon",18),r.TgZ(28,"ion-label")(29,"h1"),r._uU(30,"Password and security"),r.qZA()()(),r.TgZ(31,"ion-item",16),r.NdJ("click",function(){return s.onSettingsMenuClick("about")}),r._UZ(32,"ion-icon",19),r.TgZ(33,"ion-label")(34,"h1"),r._uU(35),r.qZA()()(),r.TgZ(36,"ion-item",16),r.NdJ("click",function(){return s.signout()}),r._UZ(37,"ion-icon",20),r.TgZ(38,"ion-label",21)(39,"h1"),r._uU(40,"Log out"),r.qZA()()()()()()()),2&l&&(r.xp6(14),r.Akn(s.isSubmitting?"opacity: 0.2":"opacity: 1"),r.Q6J("src",null==s.currentUser?null:s.currentUser.userProfilePic,r.LSH),r.xp6(4),r.Oqu(null==s.currentUser?null:s.currentUser.fullName),r.xp6(17),r.hij("About ZamsConnect Version ",s.version,""))},dependencies:[g.BJ,g.YG,g.Sm,g.W2,g.Gu,g.gu,g.Ie,g.Q$,g.q_,g.wd,g.sr],styles:["ion-header[_ngcontent-%COMP%]:after{background-image:none}.content[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{display:flex}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{margin-top:10px;flex-direction:column;align-items:center}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{display:flex;padding:5px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{min-width:103px;min-height:103px}.content[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:600!important}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]{margin-top:20px;flex-direction:column;display:flex;flex-grow:1}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{max-height:max-content!important}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{max-height:max-content!important;white-space:break-spaces!important;line-height:1;height:-webkit-fill-available}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0!important;line-height:1.2!important}.content[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   ion-item.active-menu[_ngcontent-%COMP%]::part(native){background-color:#f5f5f5}"]})}}}]);