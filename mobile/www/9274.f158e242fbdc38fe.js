"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9274],{9274:(M,f,e)=>{e.r(f),e.d(f,{SearchStudentsBySchoolPageModule:()=>C});var u=e(6895),s=e(4006),i=e(603),l=e(9773),g=e(5861),m=e(13),S=e(5778),t=e(4650),O=e(3013),r=e(4982),c=e(7956),p=e(263),_=e(7559),y=e(3746),I=e(7392),x=e(9549),E=e(4144);function B(d,n){1&d&&t._UZ(0,"div",15)}function b(d,n){if(1&d){const o=t.EpF();t.TgZ(0,"mat-icon",16),t.NdJ("click",function(){t.CHM(o);const h=t.oxw();return t.KtG(h.searchKey.setValue(""))}),t._uU(1," close "),t.qZA()}}function U(d,n){if(1&d&&(t.TgZ(0,"ion-item",17)(1,"ion-label")(2,"h2",18)(3,"strong"),t._uU(4),t.qZA()(),t.TgZ(5,"h2",19),t._uU(6),t.qZA()(),t._UZ(7,"ion-radio",20),t.qZA()),2&d){const o=n.$implicit;t.xp6(4),t.Oqu(o.fullName),t.xp6(2),t.Oqu(o.schoolYearLevel.name),t.xp6(1),t.Q6J("value",o.studentId)}}function T(d,n){if(1&d){const o=t.EpF();t.TgZ(0,"ion-item",21),t.NdJ("click",function(){t.CHM(o);const h=t.oxw();return t.KtG(h.loadMore())}),t.TgZ(1,"ion-label")(2,"h2"),t._uU(3,"Load More"),t.qZA()()()}}function A(d,n){if(1&d){const o=t.EpF();t.TgZ(0,"ion-footer")(1,"ion-toolbar",22)(2,"ion-button",23),t.NdJ("click",function(){t.CHM(o);const h=t.oxw();return t.KtG(h.select())}),t._uU(3," Select "),t.qZA()()()}}class P{parentsService;studentsService;formBuilder;alertController;pageLoaderService;authService;modalCtrl;animationService;storageService;modal;searchKey=new s.NI(null);selectedStudentId=new s.NI(null,[s.kI.required]);currentUser;selectedStudent;schoolCode;isSubmitting=!1;isLoading=!1;isSelectionLoading=!0;canFocus=!0;students=[];pageIndex=0;pageSize=10;total=0;order={studentCode:"DESC"};constructor(n,o,a,h,Z,L,Y,D,F){this.parentsService=n,this.studentsService=o,this.formBuilder=a,this.alertController=h,this.pageLoaderService=Z,this.authService=L,this.modalCtrl=Y,this.animationService=D,this.storageService=F,this.currentUser=this.storageService.getLoginUser()}get isAuthenticated(){const n=this.storageService.getLoginUser();return n&&n?.parentCode&&n?.user&&n?.user?.userId}ngOnInit(){(!this.selectedStudent||!this.selectedStudent?.studentId||""===this.selectedStudent?.studentId)&&(this.isSelectionLoading=!1),this.loadStudents(),this.searchKey.valueChanges.pipe((0,m.b)(1e3),(0,S.x)()).subscribe(n=>{this.loadStudents()}),this.selectedStudent&&this.selectedStudent?.studentId&&""!==this.selectedStudent?.studentId&&this.selectedStudentId.valueChanges.pipe((0,m.b)(100),(0,S.x)()).subscribe(n=>{this.canFocus&&document.querySelector("ion-item.item-radio-checked")&&(document.querySelector("ion-item.item-radio-checked").scrollIntoView(!1),this.isSelectionLoading=!1,this.canFocus=!1)})}loadStudents(){this.isLoading=!0,this.studentsService.getByAdvanceSearch({order:this.order,columnDef:[{apiNotation:"fullName",filter:this.searchKey.value??""},{apiNotation:"school.schoolCode",filter:this.schoolCode??""}],pageIndex:this.pageIndex,pageSize:this.pageSize}).subscribe(n=>{this.isLoading=!1,this.students=this.pageIndex>0?[...this.students,...n.data.results]:n.data.results,this.total=n.data.total,console.log(this.students),this.selectedStudent&&this.selectedStudent.studentId&&(this.selectedStudentId.setValue(this.selectedStudent.studentId),this.students.some(o=>o.studentId===this.selectedStudent.studentId)||(this.students=[this.selectedStudent,...this.students]))})}loadMore(){this.pageIndex=this.pageIndex+1,this.loadStudents()}select(){this.selectedStudent=this.students.find(n=>n.studentId===this.selectedStudentId.value.toString()),this.modal.dismiss(this.selectedStudent,"confirm")}close(){this.modal.dismiss(null,"cancel")}presentAlert(n){var o=this;return(0,g.Z)(function*(){return yield(yield o.alertController.create(n)).present()})()}static \u0275fac=function(o){return new(o||P)(t.Y36(O.l),t.Y36(r.q),t.Y36(s.qu),t.Y36(i.Br),t.Y36(c.p),t.Y36(p.e),t.Y36(i.IN),t.Y36(_.Y),t.Y36(y.V))};static \u0275cmp=t.Xpm({type:P,selectors:[["app-search-students-by-school"]],decls:15,vars:7,consts:[["class","loader-cover",4,"ngIf"],["mode","md",1,"ion-padding"],[2,"display","flex","flex-direction","column"],[1,"search-header"],["slot","start"],[3,"click"],["name","chevron-back","color","primary",2,"font-size","2em!important"],["appearance","outline"],["matInput","","type","text","placeholder","Search Student",3,"formControl"],["matSuffix","",3,"click",4,"ngIf"],[1,"search-result"],[3,"formControl"],["fill","outline","lines","none",4,"ngFor","ngForOf"],["lines","none","class","load-more",3,"click",4,"ngIf"],[4,"ngIf"],[1,"loader-cover"],["matSuffix","",3,"click"],["fill","outline","lines","none"],[1,"title"],[1,"desc"],["slot","end",3,"value"],["lines","none",1,"load-more",3,"click"],["mode","md"],["mode","md","type","submit","expand","full","shape","round","size","large","color","primary",3,"click"]],template:function(o,a){1&o&&(t.YNc(0,B,1,0,"div",0),t.TgZ(1,"ion-content",1)(2,"div",2)(3,"div",3)(4,"ion-buttons",4)(5,"ion-button",5),t.NdJ("click",function(){return a.close()}),t._UZ(6,"ion-icon",6),t.qZA()(),t.TgZ(7,"mat-form-field",7),t._UZ(8,"input",8),t.YNc(9,b,2,0,"mat-icon",9),t.qZA()(),t.TgZ(10,"div",10)(11,"ion-radio-group",11),t.YNc(12,U,8,3,"ion-item",12),t.qZA(),t.YNc(13,T,4,0,"ion-item",13),t.qZA()()(),t.YNc(14,A,4,0,"ion-footer",14)),2&o&&(t.Q6J("ngIf",a.isSelectionLoading||a.isLoading),t.xp6(8),t.Q6J("formControl",a.searchKey),t.xp6(1),t.Q6J("ngIf",a.searchKey.value&&""!==a.searchKey.value),t.xp6(2),t.Q6J("formControl",a.selectedStudentId),t.xp6(1),t.Q6J("ngForOf",a.students),t.xp6(1),t.Q6J("ngIf",a.students.length<a.total),t.xp6(1),t.Q6J("ngIf",a.selectedStudentId.valid))},dependencies:[u.sg,u.O5,I.Hw,x.KE,x.R9,E.Nt,i.YG,i.Sm,i.W2,i.fr,i.gu,i.Ie,i.Q$,i.B7,i.se,i.sr,i.U5,i.QI,s.Fj,s.JJ,s.oH],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], span[_ngcontent-%COMP%], p[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin:0}ion-header[_ngcontent-%COMP%]:after{background-image:none}.search-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;position:fixed;width:100%;left:0;top:0;padding:5px 16px!important;z-index:99!important;background:#fff}.search-header[_ngcontent-%COMP%]     mat-form-field{flex-grow:1;margin-left:20px!important;margin-right:10px!important}.search-header[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{padding:0!important}.search-header[_ngcontent-%COMP%]     mat-form-field .mat-form-field-flex{display:flex;flex-direction:row;align-items:center;height:50px!important}.search-header[_ngcontent-%COMP%]     mat-form-field .mat-form-field-infix{border:none!important;top:3px!important}.search-header[_ngcontent-%COMP%]     mat-form-field .mat-form-field-pefix{display:flex;flex-direction:column;align-items:center;justify-content:center}.search-header[_ngcontent-%COMP%]     mat-form-field .mat-form-field-suffix{display:flex;flex-direction:column;align-items:center;justify-content:center}.search-header[_ngcontent-%COMP%]     mat-form-field mat-icon{line-height:1;height:100%;width:100%;font-size:2rem;opacity:.7}.search-header[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0!important}.search-result[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:80px!important;box-sizing:border-box}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;row-gap:15px!important;box-sizing:border-box}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item{display:flex;flex-grow:1;width:100%}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item::part(native){border-radius:15px!important;flex-grow:1;height:100%;min-width:100%!important}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item.item-radio-checked::part(native){border-color:#00acc1}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item.item-radio-checked ion-label{opacity:1}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item ion-label{display:flex;flex-direction:column;opacity:.7;white-space:break-spaces!important}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item ion-label .title{overflow:hidden;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item ion-label .desc{overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.search-result[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]     ion-item ion-radio{margin:0!important;opacity:0!important}.search-result[_ngcontent-%COMP%]   .load-more[_ngcontent-%COMP%]{margin-top:20px!important}.loader-cover[_ngcontent-%COMP%]{position:fixed;left:0;top:0;width:100%;height:100%;background-color:#8f8f8f9e}ion-footer[_ngcontent-%COMP%]{display:flex}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{display:flex;padding:5px 10px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;flex-grow:1;font-size:18px;width:100%;margin:0!important}"]})}const K=[{path:"",component:P}];class v{static \u0275fac=function(o){return new(o||v)};static \u0275mod=t.oAB({type:v});static \u0275inj=t.cJS({imports:[l.Bz.forChild(K),l.Bz]})}var N=e(9544);class C{static \u0275fac=function(o){return new(o||C)};static \u0275mod=t.oAB({type:C});static \u0275inj=t.cJS({imports:[u.ez,N.q,i.Pc,s.u5,s.UX,v]})}},3013:(M,f,e)=>{e.d(f,{l:()=>t});var u=e(1086),s=e(2868),i=e(7221),l=e(2340),g=e(4650),m=e(529),S=e(9709);class t{http;appconfig;constructor(r,c){this.http=r,this.appconfig=c}getByAdvanceSearch(r){return this.http.post(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByAdvanceSearch,r).pipe((0,s.b)(c=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}getByCode(r){return this.http.get(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.getByCode+r).pipe((0,s.b)(c=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}create(r){return this.http.post(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.create,r).pipe((0,s.b)(c=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}updateProfile(r,c){return this.http.put(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfile+r,c).pipe((0,s.b)(p=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}resetPassword(r,c){return this.http.put(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.resetPassword+r,c).pipe((0,s.b)(p=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}updateProfilePicture(r,c){return this.http.put(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.updateProfilePicture+r,c).pipe((0,s.b)(p=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}delete(r){return this.http.delete(l.N.apiBaseUrl+this.appconfig.config.apiEndPoints.parents.delete+r).pipe((0,s.b)(c=>this.log("parents")),(0,i.K)(this.handleError("parents",[])))}handleError(r="operation",c){return p=>(this.log(`${r} failed: ${Array.isArray(p.error.message)?p.error.message[0]:p.error.message}`),(0,u.of)(p.error))}log(r){console.log(r)}static \u0275fac=function(c){return new(c||t)(g.LFG(m.eN),g.LFG(S._))};static \u0275prov=g.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}}}]);